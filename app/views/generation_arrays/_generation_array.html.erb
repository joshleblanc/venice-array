<div id="<%= dom_id generation_array %>" class="w-full">
  <!-- Main Prompt -->
  <div class="mb-6">
    <div data-controller="clipboard" data-clipboard-success-content-value="Copied!">
      <h3 class="heading-font text-2xl font-semibold text-gray-800 mb-3" data-clipboard-target="source">
        <%= generation_array.prompt %>
      </h3>
      <button class="cursor-pointer" type="button" data-action="clipboard#copy" data-clipboard-target="button">Copy Prompt</button>
    </div>
    <% if generation_array.negative_prompt.present? %>
      <p class="text-gray-600 italic">
        <span class="font-medium">Avoiding:</span> <%= generation_array.negative_prompt %>
      </p>
    <% end %>
  </div>

  <!-- Model and Settings -->
  <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
    <div>
      <h4 class="font-semibold text-gray-700 mb-3">Model & Settings</h4>
      <div class="space-y-2">
        <div class="flex items-center justify-between">
          <span class="text-gray-600">Model:</span>
          <span class="badge badge-warm"><%= generation_array.image_model.name %></span>
        </div>
        <div class="flex items-center justify-between">
          <span class="text-gray-600">CFG Scale:</span>
          <span class="font-medium text-gray-800"><%= generation_array.cfg_scale %></span>
        </div>
        <div class="flex items-center justify-between">
          <span class="text-gray-600">Steps:</span>
          <span class="font-medium text-gray-800"><%= generation_array.steps %></span>
        </div>
        <div class="flex items-center justify-between">
          <span class="text-gray-600">LoRA Strength:</span>
          <span class="font-medium text-gray-800"><%= generation_array.lora_strength %>%</span>
        </div>
      </div>
    </div>

    <div>
      <h4 class="font-semibold text-gray-700 mb-3">Generation Info</h4>
      <div class="space-y-2">
        <div class="flex items-center justify-between">
          <span class="text-gray-600">Seed:</span>
          <span class="font-mono text-sm text-gray-800"><%= generation_array.seed %></span>
        </div>
        <div class="flex items-center justify-between">
          <span class="text-gray-600">Safe Mode:</span>
          <% if generation_array.safe_mode? %>
            <span class="badge badge-sage">Enabled</span>
          <% else %>
            <span class="badge badge-rose">Disabled</span>
          <% end %>
        </div>
        <div class="flex items-center justify-between">
          <span class="text-gray-600">Created:</span>
          <span class="text-gray-800"><%= generation_array.created_at.strftime("%B %d, %Y") %></span>
        </div>
      </div>
    </div>
  </div>

  <!-- Cost Estimate -->
  <% if generation_array.estimated_total_cost.present? %>
    <div class="mb-6">
      <h4 class="font-semibold text-gray-700 mb-3">Estimated Cost</h4>
      <div class="space-y-2">
        <% per = generation_array.estimated_cost_per_image %>
        <% total = generation_array.estimated_total_cost %>
        <% count = generation_array.estimated_generation_count %>
        <div class="flex items-center justify-between">
          <span class="text-gray-600">Images:</span>
          <span class="font-medium text-gray-800"><%= count %></span>
        </div>
        <div class="flex items-center justify-between">
          <span class="text-gray-600">Per image:</span>
          <span class="font-medium text-gray-800">
            <%= number_to_currency(per["USD"].to_f) if per["USD"].present? %>
            <%= " | #{per["DIEM"].to_f.round(4)} DIEM" if per["DIEM"].present? %>
          </span>
        </div>
        <div class="flex items-center justify-between">
          <span class="text-gray-600">Total:</span>
          <span class="font-medium text-gray-800">
            <%= number_to_currency(total["USD"].to_f) if total["USD"].present? %>
            <%= " | #{total["DIEM"].to_f.round(4)} DIEM" if total["DIEM"].present? %>
          </span>
        </div>
      </div>
    </div>
  <% end %>

  <!-- Selected Styles -->
  <div>
    <h4 class="font-semibold text-gray-700 mb-3">Style Selection</h4>
    <% if generation_array.selected_styles.present? && generation_array.selected_styles.any? %>
      <div class="flex flex-wrap gap-2">
        <% generation_array.selected_styles.each do |style| %>
          <span class="badge badge-rose"><%= style %></span>
        <% end %>
      </div>
    <% else %>
      <p class="text-gray-600 italic">All available styles selected</p>
    <% end %>
  </div>
</div>
